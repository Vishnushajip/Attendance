{
    "sourceFile": "lib/Screens/leavehistory.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 23,
            "patches": [
                {
                    "date": 1741806128625,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1741807096966,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,41 +1,41 @@\n-import 'package:flutter/material.dart';\r\n-import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n-import 'package:google_fonts/google_fonts.dart';\r\n-import '../providers/leave_provider.dart';\r\n+// import 'package:flutter/material.dart';\r\n+// import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n+// import 'package:google_fonts/google_fonts.dart';\r\n+// import '../providers/leave_provider.dart';\r\n \r\n-class LeaveHistoryScreen extends ConsumerWidget {\r\n-  const LeaveHistoryScreen({super.key});\r\n+// class LeaveHistoryScreen extends ConsumerWidget {\r\n+//   const LeaveHistoryScreen({super.key});\r\n \r\n-  @override\r\n-  Widget build(BuildContext context, WidgetRef ref) {\r\n-    final leaveHistory = ref.watch(leaveHistoryProvider);\r\n+//   @override\r\n+//   Widget build(BuildContext context, WidgetRef ref) {\r\n+//     final leaveHistory = ref.watch(leaveHistoryProvider);\r\n \r\n-    return Scaffold(\r\n-      appBar: AppBar(\r\n-        title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n-      ),\r\n-      body: leaveHistory.when(\r\n-        data: (leaves) => leaves.isEmpty\r\n-            ? Center(child: Text(\"No leave history found.\", style: GoogleFonts.poppins(fontSize: 16)))\r\n-            : ListView.builder(\r\n-                itemCount: leaves.length,\r\n-                itemBuilder: (context, index) {\r\n-                  final leave = leaves[index];\r\n-                  return ExpansionTile(\r\n-                    title: Text(\"${leave['leaveType']} (${leave['status']})\", style: GoogleFonts.poppins(fontSize: 16)),\r\n-                    children: [\r\n-                      ListTile(\r\n-                        title: Text(\"From: ${leave['startDate']}\"),\r\n-                        subtitle: Text(\"To: ${leave['endDate']}\"),\r\n-                        trailing: Text(\"Reason: ${leave['reason']}\"),\r\n-                      ),\r\n-                    ],\r\n-                  );\r\n-                },\r\n-              ),\r\n-        loading: () => const Center(child: CircularProgressIndicator()),\r\n-        error: (e, _) => Center(child: Text(\"Error fetching leave history\")),\r\n-      ),\r\n-    );\r\n-  }\r\n-}\r\n+//     return Scaffold(\r\n+//       appBar: AppBar(\r\n+//         title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n+//       ),\r\n+//       body: leaveHistory.when(\r\n+//         data: (leaves) => leaves.isEmpty\r\n+//             ? Center(child: Text(\"No leave history found.\", style: GoogleFonts.poppins(fontSize: 16)))\r\n+//             : ListView.builder(\r\n+//                 itemCount: leaves.length,\r\n+//                 itemBuilder: (context, index) {\r\n+//                   final leave = leaves[index];\r\n+//                   return ExpansionTile(\r\n+//                     title: Text(\"${leave['leaveType']} (${leave['status']})\", style: GoogleFonts.poppins(fontSize: 16)),\r\n+//                     children: [\r\n+//                       ListTile(\r\n+//                         title: Text(\"From: ${leave['startDate']}\"),\r\n+//                         subtitle: Text(\"To: ${leave['endDate']}\"),\r\n+//                         trailing: Text(\"Reason: ${leave['reason']}\"),\r\n+//                       ),\r\n+//                     ],\r\n+//                   );\r\n+//                 },\r\n+//               ),\r\n+//         loading: () => const Center(child: CircularProgressIndicator()),\r\n+//         error: (e, _) => Center(child: Text(\"Error fetching leave history\")),\r\n+//       ),\r\n+//     );\r\n+//   }\r\n+// }\r\n"
                },
                {
                    "date": 1741807269248,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,41 +1,38 @@\n-// import 'package:flutter/material.dart';\r\n-// import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n-// import 'package:google_fonts/google_fonts.dart';\r\n-// import '../providers/leave_provider.dart';\r\n \r\n-// class LeaveHistoryScreen extends ConsumerWidget {\r\n-//   const LeaveHistoryScreen({super.key});\r\n \r\n-//   @override\r\n-//   Widget build(BuildContext context, WidgetRef ref) {\r\n-//     final leaveHistory = ref.watch(leaveHistoryProvider);\r\n+class LeaveHistoryScreen extends ConsumerWidget {\r\n+  const LeaveHistoryScreen({super.key});\r\n \r\n-//     return Scaffold(\r\n-//       appBar: AppBar(\r\n-//         title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n-//       ),\r\n-//       body: leaveHistory.when(\r\n-//         data: (leaves) => leaves.isEmpty\r\n-//             ? Center(child: Text(\"No leave history found.\", style: GoogleFonts.poppins(fontSize: 16)))\r\n-//             : ListView.builder(\r\n-//                 itemCount: leaves.length,\r\n-//                 itemBuilder: (context, index) {\r\n-//                   final leave = leaves[index];\r\n-//                   return ExpansionTile(\r\n-//                     title: Text(\"${leave['leaveType']} (${leave['status']})\", style: GoogleFonts.poppins(fontSize: 16)),\r\n-//                     children: [\r\n-//                       ListTile(\r\n-//                         title: Text(\"From: ${leave['startDate']}\"),\r\n-//                         subtitle: Text(\"To: ${leave['endDate']}\"),\r\n-//                         trailing: Text(\"Reason: ${leave['reason']}\"),\r\n-//                       ),\r\n-//                     ],\r\n-//                   );\r\n-//                 },\r\n-//               ),\r\n-//         loading: () => const Center(child: CircularProgressIndicator()),\r\n-//         error: (e, _) => Center(child: Text(\"Error fetching leave history\")),\r\n-//       ),\r\n-//     );\r\n-//   }\r\n-// }\r\n+  @override\r\n+  Widget build(BuildContext context, WidgetRef ref) {\r\n+    final leaveHistory = ref.watch(leaveHistoryProvider);\r\n+\r\n+    return Scaffold(\r\n+      appBar: AppBar(\r\n+        title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n+      ),\r\n+      body: leaveHistory.when(\r\n+        data: (leaves) => leaves.isEmpty\r\n+            ? Center(child: Text(\"No leave history found.\", style: GoogleFonts.poppins(fontSize: 16)))\r\n+            : ListView.builder(\r\n+                itemCount: leaves.length,\r\n+                itemBuilder: (context, index) {\r\n+                  final leave = leaves[index];\r\n+                  return ExpansionTile(\r\n+                    title: Text(\"${leave['leaveType']} (${leave['status']})\", style: GoogleFonts.poppins(fontSize: 16)),\r\n+                    children: [\r\n+                      ListTile(\r\n+                        title: Text(\"From: ${leave['startDate']}\"),\r\n+                        subtitle: Text(\"To: ${leave['endDate']}\"),\r\n+                        trailing: Text(\"Reason: ${leave['reason']}\"),\r\n+                      ),\r\n+                    ],\r\n+                  );\r\n+                },\r\n+              ),\r\n+        loading: () => const Center(child: CircularProgressIndicator()),\r\n+        error: (e, _) => Center(child: Text(\"Error fetching leave history\")),\r\n+      ),\r\n+    );\r\n+  }\r\n+}\r\n"
                },
                {
                    "date": 1741807277751,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,9 @@\n \r\n \r\n+import 'package:flutter/material.dart';\r\n+import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n+\r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n"
                },
                {
                    "date": 1741807285174,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,12 @@\n \r\n \r\n import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n+import 'package:google_fonts/google_fonts.dart';\r\n \r\n+import '../providers/leave_provider.dart';\r\n+\r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n"
                },
                {
                    "date": 1741807306474,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,8 @@\n \r\n import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n-\r\n import '../providers/leave_provider.dart';\r\n \r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n"
                },
                {
                    "date": 1741807322812,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,8 @@\n \r\n import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n-import '../providers/leave_provider.dart';\r\n \r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n \r\n"
                },
                {
                    "date": 1741807332273,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n \r\n-\r\n+import 'package:attendance/providers/leave_provider.dart';\r\n import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n \r\n"
                },
                {
                    "date": 1741807401249,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,4 @@\n-\r\n import 'package:attendance/providers/leave_provider.dart';\r\n import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n@@ -11,9 +10,9 @@\n   Widget build(BuildContext context, WidgetRef ref) {\r\n     final leaveHistory = ref.watch(leaveHistoryProvider);\r\n \r\n     return Scaffold(\r\n-      appBar: AppBar(\r\n+      appBar: AppBar(c\r\n         title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n       ),\r\n       body: leaveHistory.when(\r\n         data: (leaves) => leaves.isEmpty\r\n"
                },
                {
                    "date": 1741807412765,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,20 +10,24 @@\n   Widget build(BuildContext context, WidgetRef ref) {\r\n     final leaveHistory = ref.watch(leaveHistoryProvider);\r\n \r\n     return Scaffold(\r\n-      appBar: AppBar(c\r\n-        title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n+      appBar: AppBar(\r\n+        centerTitle: true,\r\n+        title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20,)),\r\n       ),\r\n       body: leaveHistory.when(\r\n         data: (leaves) => leaves.isEmpty\r\n-            ? Center(child: Text(\"No leave history found.\", style: GoogleFonts.poppins(fontSize: 16)))\r\n+            ? Center(\r\n+                child: Text(\"No leave history found.\",\r\n+                    style: GoogleFonts.poppins(fontSize: 16)))\r\n             : ListView.builder(\r\n                 itemCount: leaves.length,\r\n                 itemBuilder: (context, index) {\r\n                   final leave = leaves[index];\r\n                   return ExpansionTile(\r\n-                    title: Text(\"${leave['leaveType']} (${leave['status']})\", style: GoogleFonts.poppins(fontSize: 16)),\r\n+                    title: Text(\"${leave['leaveType']} (${leave['status']})\",\r\n+                        style: GoogleFonts.poppins(fontSize: 16)),\r\n                     children: [\r\n                       ListTile(\r\n                         title: Text(\"From: ${leave['startDate']}\"),\r\n                         subtitle: Text(\"To: ${leave['endDate']}\"),\r\n"
                },
                {
                    "date": 1741807462727,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,11 +10,12 @@\n   Widget build(BuildContext context, WidgetRef ref) {\r\n     final leaveHistory = ref.watch(leaveHistoryProvider);\r\n \r\n     return Scaffold(\r\n+      backgroundColor: Colors.white,\r\n       appBar: AppBar(\r\n         centerTitle: true,\r\n-        title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20,)),\r\n+        title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n       ),\r\n       body: leaveHistory.when(\r\n         data: (leaves) => leaves.isEmpty\r\n             ? Center(\r\n"
                },
                {
                    "date": 1741807487626,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,8 +12,9 @@\n \r\n     return Scaffold(\r\n       backgroundColor: Colors.white,\r\n       appBar: AppBar(\r\n+        backgroundColor: Colors.white,\r\n         centerTitle: true,\r\n         title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n       ),\r\n       body: leaveHistory.when(\r\n"
                },
                {
                    "date": 1741807957046,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,12 @@\n                     ],\r\n                   );\r\n                 },\r\n               ),\r\n-        loading: () => const Center(child: CircularProgressIndicator()),\r\n+        loading: () => const Center(\r\n+            child: CircularProgressIndicator(\r\n+          color: Colors.black,\r\n+        )),\r\n         error: (e, _) => Center(child: Text(\"Error fetching leave history\")),\r\n       ),\r\n     );\r\n   }\r\n"
                },
                {
                    "date": 1741808293427,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,5 @@\n-import 'package:attendance/providers/leave_provider.dart';\r\n-import 'package:flutter/material.dart';\r\n+\\import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n \r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n"
                },
                {
                    "date": 1741808306790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,10 @@\n-\\import 'package:flutter/material.dart';\r\n+import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n \r\n+import '../providers/leave_provider.dart';\r\n+\r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n"
                },
                {
                    "date": 1741808328407,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,9 @@\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n   Widget build(BuildContext context, WidgetRef ref) {\r\n-    final leaveHistory = ref.watch(leaveHistoryProvider);\r\n+    final leaveHistory = ref.watch(leaveHistoryProviders);\r\n \r\n     return Scaffold(\r\n       backgroundColor: Colors.white,\r\n       appBar: AppBar(\r\n"
                },
                {
                    "date": 1741808339034,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,9 @@\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n   Widget build(BuildContext context, WidgetRef ref) {\r\n-    final leaveHistory = ref.watch(leaveHistoryProviders);\r\n+    final leaveHistory = ref.watch(leaveHistoryProvider);\r\n \r\n     return Scaffold(\r\n       backgroundColor: Colors.white,\r\n       appBar: AppBar(\r\n"
                },
                {
                    "date": 1741808380947,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,9 @@\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n   Widget build(BuildContext context, WidgetRef ref) {\r\n-    final leaveHistory = ref.watch(leaveHistoryProvider);\r\n+    final leaveHistory = ref.watch(leaveRequestProviders);\r\n \r\n     return Scaffold(\r\n       backgroundColor: Colors.white,\r\n       appBar: AppBar(\r\n"
                },
                {
                    "date": 1741808389258,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n \r\n+import '../Providers/leave_provider.dart';\r\n import '../providers/leave_provider.dart';\r\n \r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n"
                },
                {
                    "date": 1741808527009,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,17 +1,15 @@\n import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n \r\n-import '../Providers/leave_provider.dart';\r\n import '../providers/leave_provider.dart';\r\n \r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n   Widget build(BuildContext context, WidgetRef ref) {\r\n-    final leaveHistory = ref.watch(leaveRequestProviders);\r\n \r\n     return Scaffold(\r\n       backgroundColor: Colors.white,\r\n       appBar: AppBar(\r\n"
                },
                {
                    "date": 1741808532815,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,8 +8,9 @@\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n   Widget build(BuildContext context, WidgetRef ref) {\r\n+    final leaveHistory = ref.watch(leaveHistoryProvider);\r\n \r\n     return Scaffold(\r\n       backgroundColor: Colors.white,\r\n       appBar: AppBar(\r\n"
                },
                {
                    "date": 1741808615442,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,10 +1,31 @@\n+import 'package:cloud_firestore/cloud_firestore.dart';\r\n import 'package:flutter/material.dart';\r\n import 'package:flutter_riverpod/flutter_riverpod.dart';\r\n import 'package:google_fonts/google_fonts.dart';\r\n+import 'package:shared_preferences/shared_preferences.dart';\r\n \r\n-import '../providers/leave_provider.dart';\r\n+/// Stream Provider for listening to leave requests in real-time\r\n+final leaveHistoryProvider = StreamProvider<List<Map<String, dynamic>>>((ref) async* {\r\n+  SharedPreferences prefs = await SharedPreferences.getInstance();\r\n+  String? userEmail = prefs.getString('user_email');\r\n \r\n+  if (userEmail == null) {\r\n+    yield []; // Return empty list if email is not found\r\n+    return;\r\n+  }\r\n+\r\n+  FirebaseFirestore firestore = FirebaseFirestore.instance;\r\n+\r\n+  yield* firestore\r\n+      .collection(\"leave_requests\")\r\n+      .where(\"userEmail\", isEqualTo: userEmail)\r\n+      .orderBy(\"appliedAt\", descending: true)\r\n+      .snapshots()\r\n+      .map((snapshot) =>\r\n+          snapshot.docs.map((doc) => doc.data() as Map<String, dynamic>).toList());\r\n+});\r\n+\r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n \r\n   @override\r\n@@ -20,31 +41,52 @@\n       ),\r\n       body: leaveHistory.when(\r\n         data: (leaves) => leaves.isEmpty\r\n             ? Center(\r\n-                child: Text(\"No leave history found.\",\r\n-                    style: GoogleFonts.poppins(fontSize: 16)))\r\n+                child: Text(\r\n+                  \"No leave history found.\",\r\n+                  style: GoogleFonts.poppins(fontSize: 16),\r\n+                ),\r\n+              )\r\n             : ListView.builder(\r\n                 itemCount: leaves.length,\r\n                 itemBuilder: (context, index) {\r\n                   final leave = leaves[index];\r\n-                  return ExpansionTile(\r\n-                    title: Text(\"${leave['leaveType']} (${leave['status']})\",\r\n-                        style: GoogleFonts.poppins(fontSize: 16)),\r\n-                    children: [\r\n-                      ListTile(\r\n-                        title: Text(\"From: ${leave['startDate']}\"),\r\n-                        subtitle: Text(\"To: ${leave['endDate']}\"),\r\n-                        trailing: Text(\"Reason: ${leave['reason']}\"),\r\n+                  return Card(\r\n+                    margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\r\n+                    elevation: 2,\r\n+                    shape: RoundedRectangleBorder(\r\n+                      borderRadius: BorderRadius.circular(10),\r\n+                    ),\r\n+                    child: ExpansionTile(\r\n+                      title: Text(\r\n+                        \"${leave['leaveType']} (${leave['status']})\",\r\n+                        style: GoogleFonts.poppins(\r\n+                          fontSize: 16,\r\n+                          fontWeight: FontWeight.bold,\r\n+                          color: leave['status'] == 'Approved'\r\n+                              ? Colors.green\r\n+                              : leave['status'] == 'Rejected'\r\n+                                  ? Colors.red\r\n+                                  : Colors.orange,\r\n+                        ),\r\n                       ),\r\n-                    ],\r\n+                      children: [\r\n+                        ListTile(\r\n+                          leading: const Icon(Icons.calendar_today, color: Colors.blue),\r\n+                          title: Text(\"From: ${leave['startDate']}\"),\r\n+                          subtitle: Text(\"To: ${leave['endDate']}\"),\r\n+                        ),\r\n+                        ListTile(\r\n+                          leading: const Icon(Icons.message, color: Colors.grey),\r\n+                          title: Text(\"Reason: ${leave['reason']}\"),\r\n+                        ),\r\n+                      ],\r\n+                    ),\r\n                   );\r\n                 },\r\n               ),\r\n-        loading: () => const Center(\r\n-            child: CircularProgressIndicator(\r\n-          color: Colors.black,\r\n-        )),\r\n+        loading: () => const Center(child: CircularProgressIndicator(color: Colors.black)),\r\n         error: (e, _) => Center(child: Text(\"Error fetching leave history\")),\r\n       ),\r\n     );\r\n   }\r\n"
                },
                {
                    "date": 1741808624504,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,14 +4,15 @@\n import 'package:google_fonts/google_fonts.dart';\r\n import 'package:shared_preferences/shared_preferences.dart';\r\n \r\n /// Stream Provider for listening to leave requests in real-time\r\n-final leaveHistoryProvider = StreamProvider<List<Map<String, dynamic>>>((ref) async* {\r\n+final leaveHistoryProvider =\r\n+    StreamProvider<List<Map<String, dynamic>>>((ref) async* {\r\n   SharedPreferences prefs = await SharedPreferences.getInstance();\r\n   String? userEmail = prefs.getString('user_email');\r\n \r\n   if (userEmail == null) {\r\n-    yield []; // Return empty list if email is not found\r\n+    yield []; \r\n     return;\r\n   }\r\n \r\n   FirebaseFirestore firestore = FirebaseFirestore.instance;\r\n@@ -20,10 +21,9 @@\n       .collection(\"leave_requests\")\r\n       .where(\"userEmail\", isEqualTo: userEmail)\r\n       .orderBy(\"appliedAt\", descending: true)\r\n       .snapshots()\r\n-      .map((snapshot) =>\r\n-          snapshot.docs.map((doc) => doc.data() as Map<String, dynamic>).toList());\r\n+      .map((snapshot) => snapshot.docs.map((doc) => doc.data()).toList());\r\n });\r\n \r\n class LeaveHistoryScreen extends ConsumerWidget {\r\n   const LeaveHistoryScreen({super.key});\r\n@@ -51,9 +51,10 @@\n                 itemCount: leaves.length,\r\n                 itemBuilder: (context, index) {\r\n                   final leave = leaves[index];\r\n                   return Card(\r\n-                    margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\r\n+                    margin:\r\n+                        const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\r\n                     elevation: 2,\r\n                     shape: RoundedRectangleBorder(\r\n                       borderRadius: BorderRadius.circular(10),\r\n                     ),\r\n@@ -71,22 +72,25 @@\n                         ),\r\n                       ),\r\n                       children: [\r\n                         ListTile(\r\n-                          leading: const Icon(Icons.calendar_today, color: Colors.blue),\r\n+                          leading: const Icon(Icons.calendar_today,\r\n+                              color: Colors.blue),\r\n                           title: Text(\"From: ${leave['startDate']}\"),\r\n                           subtitle: Text(\"To: ${leave['endDate']}\"),\r\n                         ),\r\n                         ListTile(\r\n-                          leading: const Icon(Icons.message, color: Colors.grey),\r\n+                          leading:\r\n+                              const Icon(Icons.message, color: Colors.grey),\r\n                           title: Text(\"Reason: ${leave['reason']}\"),\r\n                         ),\r\n                       ],\r\n                     ),\r\n                   );\r\n                 },\r\n               ),\r\n-        loading: () => const Center(child: CircularProgressIndicator(color: Colors.black)),\r\n+        loading: () =>\r\n+            const Center(child: CircularProgressIndicator(color: Colors.black)),\r\n         error: (e, _) => Center(child: Text(\"Error fetching leave history\")),\r\n       ),\r\n     );\r\n   }\r\n"
                },
                {
                    "date": 1741808682894,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,9 +49,9 @@\n             : ListView.builder(\r\n                 itemCount: leaves.length,\r\n                 itemBuilder: (context, index) {\r\n                   final leave = leaves[index];\r\n-                  return Card(c\r\n+                  return Card(color: ,\r\n                     margin:\r\n                         const EdgeInsets.symmetric(horizontal: 16, vertical: 8),\r\n                     elevation: 2,\r\n                     shape: RoundedRectangleBorder(\r\n"
                }
            ],
            "date": 1741806128625,
            "name": "Commit-0",
            "content": "import 'package:flutter/material.dart';\r\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\r\nimport 'package:google_fonts/google_fonts.dart';\r\nimport '../providers/leave_provider.dart';\r\n\r\nclass LeaveHistoryScreen extends ConsumerWidget {\r\n  const LeaveHistoryScreen({super.key});\r\n\r\n  @override\r\n  Widget build(BuildContext context, WidgetRef ref) {\r\n    final leaveHistory = ref.watch(leaveHistoryProvider);\r\n\r\n    return Scaffold(\r\n      appBar: AppBar(\r\n        title: Text(\"Leave History\", style: GoogleFonts.poppins(fontSize: 20)),\r\n      ),\r\n      body: leaveHistory.when(\r\n        data: (leaves) => leaves.isEmpty\r\n            ? Center(child: Text(\"No leave history found.\", style: GoogleFonts.poppins(fontSize: 16)))\r\n            : ListView.builder(\r\n                itemCount: leaves.length,\r\n                itemBuilder: (context, index) {\r\n                  final leave = leaves[index];\r\n                  return ExpansionTile(\r\n                    title: Text(\"${leave['leaveType']} (${leave['status']})\", style: GoogleFonts.poppins(fontSize: 16)),\r\n                    children: [\r\n                      ListTile(\r\n                        title: Text(\"From: ${leave['startDate']}\"),\r\n                        subtitle: Text(\"To: ${leave['endDate']}\"),\r\n                        trailing: Text(\"Reason: ${leave['reason']}\"),\r\n                      ),\r\n                    ],\r\n                  );\r\n                },\r\n              ),\r\n        loading: () => const Center(child: CircularProgressIndicator()),\r\n        error: (e, _) => Center(child: Text(\"Error fetching leave history\")),\r\n      ),\r\n    );\r\n  }\r\n}\r\n"
        }
    ]
}